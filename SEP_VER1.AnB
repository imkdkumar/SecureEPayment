
Protocol: SEP_VER1

Types:
Agent C, M, PG;
Number OD, PRICE;
Function sk,pk,card_number,secretk;

Knowledge:

C: M,C,PG,pk(M),pk(C),pk(PG),inv(pk(C)), secretk(M), secretk(C);
M: C,M,PG,pk(M),pk(C),pk(PG),inv(pk(M)),secretk(M), secretk(C);
PG: C,M,PG,pk(M),pk(C),pk(PG),inv(pk(PG));

Actions:

C->M : C,M,OD, 
M->C : C,M,OD,PRICE
C->PG : C,PRICE,card_number(C)


Goals:

M authenticates C on secretk(C)
C authenticates C on secretk(M)
OD secret between M,C
#OD secret between PG,M
