
Protocol: SEP_VER1

Types:
Agent C, M, PG;
Number OD, PRICE;
Function sk,pk,card_number,secretk;
Symmetric_key KCM;

Knowledge:

C: M,C,PG,pk(M),pk(PG),inv(pk(C)), card_number(C), sk(C,M);
M: C,M,PG,pk(M),pk(PG),inv(pk(M));
PG: C,M,PG,pk(M),pk(PG),inv(pk(PG));

Actions:

C->M : {C,M,OD, KCM}pk(M) 
M->C : {|C,M,OD,PRICE|}KCM
C->M : {OD, PRICE, card_number(C)}pk(M)

Goals:

C authenticates M on OD, PRICE

